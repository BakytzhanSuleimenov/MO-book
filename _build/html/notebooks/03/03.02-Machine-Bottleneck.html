
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Machine Bottleneck &#8212; Companion Notebooks for Mathematical Optimization</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Job Shop Scheduling" href="03.03-Job-Shop-Scheduling.html" />
    <link rel="prev" title="Chapter 3" href="03.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo-mo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Companion Notebooks for Mathematical Optimization</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../pyomo_style_guide.html">
   Pyomo Style Guide
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/01.html">
   Chapter 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/DSE_5_1_2021_Alice%27s_rose.html">
     Data Science Essentials: Applied Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/Pop-Up-Shop.html">
     Scenario Analysis: Pop Up Shop
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/02.html">
   Chapter 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/EF_RO.html">
     Companion notebook to EF’s training on optimization with data uncertainty
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="03.html">
   Chapter 3
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Machine Bottleneck
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.03-Job-Shop-Scheduling.html">
     Job Shop Scheduling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.04-Maintenance-Planning.html">
     Maintenance Planning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.05-State-Task-Networks.html">
     Scheduling Multipurpose Batch Processes using State-Task Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03.06-Unit-Commitment.html">
     Unit Commitment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04/04.html">
   Chapter 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05/05.html">
   Chapter 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06/06.html">
   Chapter 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07/07.html">
   Chapter 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08/08.html">
   Chapter 8
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09/09.html">
   Chapter 11
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../10/10.html">
   Chapter 10
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11/11.html">
   Chapter 11
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/03/03.02-Machine-Bottleneck.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jckantor/MO-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/jckantor/MO-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/03/03.02-Machine-Bottleneck.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/jckantor/MO-book/main?urlpath=tree/notebooks/03/03.02-Machine-Bottleneck.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/jckantor/MO-book/blob/main/notebooks/03/03.02-Machine-Bottleneck.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   Example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gantt-chart">
     Gantt chart
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-machine-scheduling-problem">
   The machine scheduling problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#key-performance-indicators">
     Key performance indicators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise">
     Exercise
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#empirical-scheduling">
   Empirical scheduling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-in-first-out">
     First-in first-out
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#last-in-first-out">
     Last-in, first-out
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#earliest-due-date">
     Earliest due date
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shortest-processing-time">
     Shortest processing time
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeling">
   Modeling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-variables">
     Decision variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#big-m-model">
   Big-M model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-an-incomplete-bare-bones-model">
     Step 1. An incomplete bare-bones model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-add-release-time-information">
     Step 2.  Add release time information
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-machine-conflict-constraints">
     Step 3. Machine conflict constraints
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-4-improve-the-objective-function">
     Step 4. Improve the objective function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyomo-model">
   Pyomo model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-machines">
   Multiple machines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#disjunctive-version">
   Disjunctive Version
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Machine Bottleneck</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   Example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gantt-chart">
     Gantt chart
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-machine-scheduling-problem">
   The machine scheduling problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#key-performance-indicators">
     Key performance indicators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise">
     Exercise
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#empirical-scheduling">
   Empirical scheduling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-in-first-out">
     First-in first-out
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#last-in-first-out">
     Last-in, first-out
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#earliest-due-date">
     Earliest due date
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shortest-processing-time">
     Shortest processing time
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeling">
   Modeling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data">
     Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-variables">
     Decision variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#big-m-model">
   Big-M model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-an-incomplete-bare-bones-model">
     Step 1. An incomplete bare-bones model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-add-release-time-information">
     Step 2.  Add release time information
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-machine-conflict-constraints">
     Step 3. Machine conflict constraints
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-4-improve-the-objective-function">
     Step 4. Improve the objective function
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyomo-model">
   Pyomo model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-machines">
   Multiple machines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#disjunctive-version">
   Disjunctive Version
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="machine-bottleneck">
<h1>Machine Bottleneck<a class="headerlink" href="#machine-bottleneck" title="Permalink to this headline">¶</a></h1>
<p>This notebook demonstrates the formulation and solution of the a machine bottleneck problem using Pyomo. The task is to schedule a set of jobs on a single machine given the release time, duration, and due time for each job. Date for the example problem is from Christelle Gueret, Christian Prins, Marc Sevaux, “Applications of Optimization with Xpress-MP,” Chapter 5, Dash Optimization, 2000.</p>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">&quot;pyomo&quot;</span><span class="p">):</span>
    <span class="o">!</span>pip install -q pyomo
    <span class="k">assert</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">&quot;pyomo&quot;</span><span class="p">))</span>

<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">&quot;cbc&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;cbc&quot;</span><span class="p">)):</span>
    <span class="k">if</span> <span class="s2">&quot;google.colab&quot;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
        <span class="o">!</span>apt-get install -y -qq coinor-cbc
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="o">!</span>conda install -c conda-forge coincbc 
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

<span class="k">assert</span><span class="p">(</span><span class="n">shutil</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="s2">&quot;cbc&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;cbc&quot;</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">pyomo.environ</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyomo.gdp</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     |████████████████████████████████| 9.4MB 537kB/s 
     |████████████████████████████████| 51kB 5.9MB/s 
     |████████████████████████████████| 256kB 25.0MB/s 
     |████████████████████████████████| 163kB 30.3MB/s 
?25hSelecting previously unselected package coinor-libcoinutils3v5.
(Reading database ... 144611 files and directories currently installed.)
Preparing to unpack .../0-coinor-libcoinutils3v5_2.10.14+repack1-1_amd64.deb ...
Unpacking coinor-libcoinutils3v5 (2.10.14+repack1-1) ...
Selecting previously unselected package coinor-libosi1v5.
Preparing to unpack .../1-coinor-libosi1v5_0.107.9+repack1-1_amd64.deb ...
Unpacking coinor-libosi1v5 (0.107.9+repack1-1) ...
Selecting previously unselected package coinor-libclp1.
Preparing to unpack .../2-coinor-libclp1_1.16.11+repack1-1_amd64.deb ...
Unpacking coinor-libclp1 (1.16.11+repack1-1) ...
Selecting previously unselected package coinor-libcgl1.
Preparing to unpack .../3-coinor-libcgl1_0.59.10+repack1-1_amd64.deb ...
Unpacking coinor-libcgl1 (0.59.10+repack1-1) ...
Selecting previously unselected package coinor-libcbc3.
Preparing to unpack .../4-coinor-libcbc3_2.9.9+repack1-1_amd64.deb ...
Unpacking coinor-libcbc3 (2.9.9+repack1-1) ...
Selecting previously unselected package coinor-cbc.
Preparing to unpack .../5-coinor-cbc_2.9.9+repack1-1_amd64.deb ...
Unpacking coinor-cbc (2.9.9+repack1-1) ...
Setting up coinor-libcoinutils3v5 (2.10.14+repack1-1) ...
Setting up coinor-libosi1v5 (0.107.9+repack1-1) ...
Setting up coinor-libclp1 (1.16.11+repack1-1) ...
Setting up coinor-libcgl1 (0.59.10+repack1-1) ...
Setting up coinor-libcbc3 (2.9.9+repack1-1) ...
Setting up coinor-cbc (2.9.9+repack1-1) ...
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
Processing triggers for libc-bin (2.27-3ubuntu1.2) ...
/sbin/ldconfig.real: /usr/local/lib/python3.6/dist-packages/ideep4py/lib/libmkldnn.so.0 is not a symbolic link
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The problem is to schedule a sequence of jobs for a single machine. The data consists of a Python dictionary of jobs. Each job is labeled by a key, and an associated data dictionary provides the time at which the job is released to the for machine processing, the expected duration of the job, and the due date. The problem is to sequence the jobs on the machine to meet the due dates, or show that no such sequence is possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">JOBS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;release&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;release&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">},</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;release&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;release&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;release&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">:</span>  <span class="mi">5</span><span class="p">},</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;release&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span>
    <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;release&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;due&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">JOBS</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;A&#39;: {&#39;due&#39;: 10, &#39;duration&#39;: 5, &#39;release&#39;: 2},
 &#39;B&#39;: {&#39;due&#39;: 21, &#39;duration&#39;: 6, &#39;release&#39;: 5},
 &#39;C&#39;: {&#39;due&#39;: 15, &#39;duration&#39;: 8, &#39;release&#39;: 4},
 &#39;D&#39;: {&#39;due&#39;: 10, &#39;duration&#39;: 4, &#39;release&#39;: 0},
 &#39;E&#39;: {&#39;due&#39;: 5, &#39;duration&#39;: 2, &#39;release&#39;: 0},
 &#39;F&#39;: {&#39;due&#39;: 15, &#39;duration&#39;: 3, &#39;release&#39;: 8},
 &#39;G&#39;: {&#39;due&#39;: 22, &#39;duration&#39;: 2, &#39;release&#39;: 9}}
</pre></div>
</div>
</div>
</div>
<div class="section" id="gantt-chart">
<h3>Gantt chart<a class="headerlink" href="#gantt-chart" title="Permalink to this headline">¶</a></h3>
<p>A traditional means of visualizing scheduling data in the form of a Gantt chart. The next cell presents a function <code class="docutils literal notranslate"><span class="pre">gantt</span></code> that plots a Gantt chart given JOBS and SCHEDULE information. Two charts are presented showing job schedule and machine schedule. If no machine information is contained in SCHEDULE, then it assumed to be a single machine operation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="o">=</span><span class="p">{}):</span>
    <span class="n">bw</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">0.7</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">()))))</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],[</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">],[</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],[</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">],[</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="n">idx</span><span class="p">,</span>
                <span class="s1">&#39;Job &#39;</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">idx</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Job Schedule&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Jobs&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)),</span> <span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">xlim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">SCHEDULE</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;machine&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;machine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">MACHINES</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;machine&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="o">.</span><span class="n">keys</span><span class="p">()]))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">0.7</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">MACHINES</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">SCHEDULE</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">MACHINES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;machine&#39;</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],[</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">],[</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">+</span><span class="n">bw</span><span class="p">,</span><span class="n">idx</span><span class="o">-</span><span class="n">bw</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span><span class="n">idx</span><span class="p">,</span>
                <span class="s1">&#39;Job &#39;</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">MACHINES</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Machine Schedule&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MACHINES</span><span class="p">)),</span> <span class="n">MACHINES</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Machines&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/03.02-Machine-Bottleneck_6_0.png" src="../../_images/03.02-Machine-Bottleneck_6_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="the-machine-scheduling-problem">
<h2>The machine scheduling problem<a class="headerlink" href="#the-machine-scheduling-problem" title="Permalink to this headline">¶</a></h2>
<p>A schedule consists of a dictionary listing the start and finish times for each job. Once the order of jobs has been determined, the start time can be no earlier than when the job is released for processing, and no earlier than the finish of the previous job.</p>
<p>The following cell presents a function which, given the JOBS data and an order list of jobs indices, computes the start and finish times for all jobs on a single machine. We use this to determine the schedule if the jobs are executed in alphabetical order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
    <span class="sd">&quot;&quot;&quot;Schedule a dictionary of JOBS on a single machine in a specified order.&quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">finish</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">order</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">],</span> <span class="n">finish</span><span class="p">)</span>
        <span class="n">finish</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">finish</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">SCHEDULE</span>   

<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
<span class="n">SCHEDULE</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;A&#39;: {&#39;finish&#39;: 7, &#39;start&#39;: 2},
 &#39;B&#39;: {&#39;finish&#39;: 13, &#39;start&#39;: 7},
 &#39;C&#39;: {&#39;finish&#39;: 21, &#39;start&#39;: 13},
 &#39;D&#39;: {&#39;finish&#39;: 25, &#39;start&#39;: 21},
 &#39;E&#39;: {&#39;finish&#39;: 27, &#39;start&#39;: 25},
 &#39;F&#39;: {&#39;finish&#39;: 30, &#39;start&#39;: 27},
 &#39;G&#39;: {&#39;finish&#39;: 32, &#39;start&#39;: 30}}
</pre></div>
</div>
</div>
</div>
<p>Here we demonstrate a ‘partial schedule’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/03.02-Machine-Bottleneck_10_0.png" src="../../_images/03.02-Machine-Bottleneck_10_0.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_10_1.png" src="../../_images/03.02-Machine-Bottleneck_10_1.png" />
</div>
</div>
<p>Here’s a schedule where jobs are done in alphabetical order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/03.02-Machine-Bottleneck_12_0.png" src="../../_images/03.02-Machine-Bottleneck_12_0.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_12_1.png" src="../../_images/03.02-Machine-Bottleneck_12_1.png" />
</div>
</div>
<div class="section" id="key-performance-indicators">
<h3>Key performance indicators<a class="headerlink" href="#key-performance-indicators" title="Permalink to this headline">¶</a></h3>
<p>As presented above, a given schedule may not meet all of the due time requirements. In fact, a schedule meeting all of the requirements might not even be possible. So given a schedule, it is useful to have a function that computes key performance indicators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">):</span>
    <span class="n">KPI</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">KPI</span><span class="p">[</span><span class="s1">&#39;Makespan&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="p">)</span>
    <span class="n">KPI</span><span class="p">[</span><span class="s1">&#39;Max Pastdue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="p">)</span>
    <span class="n">KPI</span><span class="p">[</span><span class="s1">&#39;Sum of Pastdue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="p">)</span>
    <span class="n">KPI</span><span class="p">[</span><span class="s1">&#39;Number Pastdue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="p">)</span>
    <span class="n">KPI</span><span class="p">[</span><span class="s1">&#39;Number on Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;finish&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">SCHEDULE</span><span class="p">)</span>
    <span class="n">KPI</span><span class="p">[</span><span class="s1">&#39;Fraction on Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KPI</span><span class="p">[</span><span class="s1">&#39;Number on Time&#39;</span><span class="p">]</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">SCHEDULE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">KPI</span>

<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.2857142857142857,
 &#39;Makespan&#39;: 32,
 &#39;Max Pastdue&#39;: 22,
 &#39;Number Pastdue&#39;: 5,
 &#39;Number on Time&#39;: 2,
 &#39;Sum of Pastdue&#39;: 68}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h3>
<p>Show the Gantt chart and key performance metrics if the jobs are executed in reverse alphabetical order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span><span class="n">order</span><span class="p">))</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span><span class="n">order</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.2857142857142857,
 &#39;Makespan&#39;: 39,
 &#39;Max Pastdue&#39;: 29,
 &#39;Number Pastdue&#39;: 5,
 &#39;Number on Time&#39;: 2,
 &#39;Sum of Pastdue&#39;: 76}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_16_1.png" src="../../_images/03.02-Machine-Bottleneck_16_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_16_2.png" src="../../_images/03.02-Machine-Bottleneck_16_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="empirical-scheduling">
<h2>Empirical scheduling<a class="headerlink" href="#empirical-scheduling" title="Permalink to this headline">¶</a></h2>
<p>There are a number of commonly encountered empirical rules for scheduling jobs on a single machine. These include:</p>
<ul class="simple">
<li><p>First-In First-Out (FIFO)</p></li>
<li><p>Last-In, First-Out (LIFO)</p></li>
<li><p>Shortest Processing Time First (SPT)</p></li>
<li><p>Earliest Due Data (EDD)</p></li>
</ul>
<div class="section" id="first-in-first-out">
<h3>First-in first-out<a class="headerlink" href="#first-in-first-out" title="Permalink to this headline">¶</a></h3>
<p>As an example, we’ll first look at ‘First-In-First-Out’ scheduling which executes job in the order they are released. The following function sorts jobs by release time, then schedules the jobs to execute in that order. A job can only be started no earlier than when it is released.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fifo</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>
    <span class="n">order_by_release</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">job</span><span class="p">:</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">order_by_release</span><span class="p">)</span>

<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">fifo</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.14285714285714285,
 &#39;Makespan&#39;: 30,
 &#39;Max Pastdue&#39;: 13,
 &#39;Number Pastdue&#39;: 6,
 &#39;Number on Time&#39;: 1,
 &#39;Sum of Pastdue&#39;: 31}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_19_1.png" src="../../_images/03.02-Machine-Bottleneck_19_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_19_2.png" src="../../_images/03.02-Machine-Bottleneck_19_2.png" />
</div>
</div>
</div>
<div class="section" id="last-in-first-out">
<h3>Last-in, first-out<a class="headerlink" href="#last-in-first-out" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lifo</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>
    <span class="n">unfinished_jobs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">unfinished_jobs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">unfinished_jobs</span><span class="p">))</span>
        <span class="n">lifo</span> <span class="o">=</span> <span class="p">{</span><span class="n">job</span><span class="p">:</span><span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">unfinished_jobs</span> <span class="k">if</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="p">}</span>
        <span class="n">job</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lifo</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">lifo</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
        <span class="n">finish</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>
        <span class="n">unfinished_jobs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">finish</span><span class="p">}</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">finish</span>
    <span class="k">return</span> <span class="n">SCHEDULE</span>          
    
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">lifo</span><span class="p">(</span><span class="n">JOBS</span><span class="p">))</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">lifo</span><span class="p">(</span><span class="n">JOBS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.5714285714285714,
 &#39;Makespan&#39;: 30,
 &#39;Max Pastdue&#39;: 20,
 &#39;Number Pastdue&#39;: 3,
 &#39;Number on Time&#39;: 4,
 &#39;Sum of Pastdue&#39;: 34}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_21_1.png" src="../../_images/03.02-Machine-Bottleneck_21_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_21_2.png" src="../../_images/03.02-Machine-Bottleneck_21_2.png" />
</div>
</div>
</div>
<div class="section" id="earliest-due-date">
<h3>Earliest due date<a class="headerlink" href="#earliest-due-date" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">edd</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>
    <span class="n">unfinished_jobs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">unfinished_jobs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">unfinished_jobs</span><span class="p">))</span>
        <span class="n">edd</span> <span class="o">=</span> <span class="p">{</span><span class="n">job</span><span class="p">:</span><span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">unfinished_jobs</span> <span class="k">if</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="p">}</span>
        <span class="n">job</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">edd</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">edd</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
        <span class="n">finish</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>
        <span class="n">unfinished_jobs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">finish</span><span class="p">}</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">finish</span>
    <span class="k">return</span> <span class="n">SCHEDULE</span>          
    
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">edd</span><span class="p">(</span><span class="n">JOBS</span><span class="p">))</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">edd</span><span class="p">(</span><span class="n">JOBS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.2857142857142857,
 &#39;Makespan&#39;: 30,
 &#39;Max Pastdue&#39;: 8,
 &#39;Number Pastdue&#39;: 5,
 &#39;Number on Time&#39;: 2,
 &#39;Sum of Pastdue&#39;: 27}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_23_1.png" src="../../_images/03.02-Machine-Bottleneck_23_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_23_2.png" src="../../_images/03.02-Machine-Bottleneck_23_2.png" />
</div>
</div>
</div>
<div class="section" id="shortest-processing-time">
<h3>Shortest processing time<a class="headerlink" href="#shortest-processing-time" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">spt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>
    <span class="n">unfinished_jobs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">unfinished_jobs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">unfinished_jobs</span><span class="p">))</span>
        <span class="n">spt</span> <span class="o">=</span> <span class="p">{</span><span class="n">job</span><span class="p">:</span><span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">unfinished_jobs</span> <span class="k">if</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="p">}</span>
        <span class="n">job</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">spt</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">spt</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
        <span class="n">finish</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>
        <span class="n">unfinished_jobs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">finish</span><span class="p">}</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">finish</span>
    <span class="k">return</span> <span class="n">SCHEDULE</span>          
    
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">spt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">))</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">spt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.42857142857142855,
 &#39;Makespan&#39;: 30,
 &#39;Max Pastdue&#39;: 15,
 &#39;Number Pastdue&#39;: 4,
 &#39;Number on Time&#39;: 3,
 &#39;Sum of Pastdue&#39;: 18}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_25_1.png" src="../../_images/03.02-Machine-Bottleneck_25_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_25_2.png" src="../../_images/03.02-Machine-Bottleneck_25_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="modeling">
<h2>Modeling<a class="headerlink" href="#modeling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h3>
<p>The data for this problem consists of a list of jobs. Each job is tagged with a unique ID along with numerical data giving the time at which the job will be released for machine processing, the expected duration, and the time at which it is due.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="text-align:left head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{ID}_{j}\)</span></p></td>
<td class="text-align:left"><p>Unique ID for task <span class="math notranslate nohighlight">\(j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{due}_{j}\)</span></p></td>
<td class="text-align:left"><p>Due time for task <span class="math notranslate nohighlight">\(j\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{duration}_{j}\)</span></p></td>
<td class="text-align:left"><p>Duration of task <span class="math notranslate nohighlight">\(j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{release}_{j}\)</span></p></td>
<td class="text-align:left"><p>Time task <span class="math notranslate nohighlight">\(j\)</span> becomes available for processing</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="decision-variables">
<h3>Decision variables<a class="headerlink" href="#decision-variables" title="Permalink to this headline">¶</a></h3>
<p>For a single machine, the essential decision variable is the start time at which the job begins processing.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="text-align:left head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{start}_{j}\)</span></p></td>
<td class="text-align:left"><p>Start of task <span class="math notranslate nohighlight">\(j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{makespan}\)</span></p></td>
<td class="text-align:left"><p>Time to complete <em>all</em> jobs.</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\text{pastdue}_{j}\)</span></p></td>
<td class="text-align:left"><p>Time by which task <span class="math notranslate nohighlight">\(j\)</span> is past due</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\text{early}_{j}\)</span></p></td>
<td class="text-align:left"><p>Time by which task <span class="math notranslate nohighlight">\(j\)</span> is finished early</p></td>
</tr>
</tbody>
</table>
<p>A job cannot start until it is released for processing
\begin{align*}
\text{start}<em>{j} &amp; \geq \text{release}</em>{j}\
\end{align*}</p>
<p>Once released for processing, we assume the processing continues until the job is finished. The finish time is compared to the due time, and the result stored in either the early or pastdue decision variables. These decision variables are needed to handle cases where it might not be possible to complete all jobs by the time they are due.</p>
<p>\begin{align*}
\text{start}<em>{j} + \text{duration}</em>{j} + \text{early}<em>{j} &amp; = \text{due}</em>{j} + \text{pastdue}<em>{j}\
\text{early}</em>{j} &amp; \geq 0 \
\text{pastdue}_{j} &amp; \geq 0
\end{align*}</p>
<p>Finally, we include a single decision variable measuring the overall makespan for all jobs.
\begin{align*}
\text{start}<em>{j} +\text{duration}</em>{j} \leq \text{makespan}
\end{align*}</p>
<p>The final set of constraints requires that, for any given pair of jobs <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(k\)</span>, that either <span class="math notranslate nohighlight">\(j\)</span> starts before <span class="math notranslate nohighlight">\(k\)</span> finishes, or <span class="math notranslate nohighlight">\(k\)</span> finishes before <span class="math notranslate nohighlight">\(j\)</span> starts. The boolean variable <span class="math notranslate nohighlight">\(y_{jk} = 1\)</span> indicates <span class="math notranslate nohighlight">\(j\)</span> finishes before <span class="math notranslate nohighlight">\(k\)</span> starts, and is 0 for the opposing case. Note that we only need to consider cases <span class="math notranslate nohighlight">\(j &gt; k\)</span></p>
<p>\begin{align*}
\text{start}<em>{i}+\text{duration}</em>{i} &amp; \leq \text{start}<em>{j}+My</em>{i,j}\
\text{start}<em>{j}+\text{duration}</em>{j} &amp; \leq \text{start}<em>{i}+M(1-y</em>{i,j})
\end{align*}</p>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is a sufficiently large enough to assure the relaxed constraint is satisfied for all plausible values of the decision variables.</p>
</div>
</div>
<div class="section" id="big-m-model">
<h2>Big-M model<a class="headerlink" href="#big-m-model" title="Permalink to this headline">¶</a></h2>
<p>We’ll take a step-by-step approach to the construction of a “Big-M” model.</p>
<div class="section" id="step-1-an-incomplete-bare-bones-model">
<h3>Step 1. An incomplete bare-bones model<a class="headerlink" href="#step-1-an-incomplete-bare-bones-model" title="Permalink to this headline">¶</a></h3>
<p>We’ll start this model building exercise with just enough variables and constraints to get an answer. This is not a complete model and will therefore give non-physical answers. But it does give a scaffold for further model building.</p>
<p>This first model includes decision variables for the start and finish of each job, a decision variable for makespan, and constraints that define the relationships among these decision variables. The objective function is to minimize makespan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>

    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    
    <span class="c1"># index set to simplify notation</span>
    <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># decision variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">finish</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># additional decision variables for use in the objecive</span>
    <span class="n">m</span><span class="o">.</span><span class="n">makespan</span>   <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># objective function</span>
    <span class="n">m</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">,</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">)</span>
    
    <span class="c1"># constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">)</span>

    <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;cbc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">](),</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]()</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]}</span>
        
    <span class="k">return</span> <span class="n">SCHEDULE</span>

<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 1.0,
 &#39;Makespan&#39;: 8.0,
 &#39;Max Pastdue&#39;: 0,
 &#39;Number Pastdue&#39;: 0,
 &#39;Number on Time&#39;: 7,
 &#39;Sum of Pastdue&#39;: 0}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_31_1.png" src="../../_images/03.02-Machine-Bottleneck_31_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_31_2.png" src="../../_images/03.02-Machine-Bottleneck_31_2.png" />
</div>
</div>
</div>
<div class="section" id="step-2-add-release-time-information">
<h3>Step 2.  Add release time information<a class="headerlink" href="#step-2-add-release-time-information" title="Permalink to this headline">¶</a></h3>
<p>Obviously some jobs are being started before they are released for processing. The next version of the model adds that constraint.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>

    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    
    <span class="c1"># index set to simplify notation</span>
    <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># decision variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">finish</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># additional decision variables for use in the objecive</span>
    <span class="n">m</span><span class="o">.</span><span class="n">makespan</span>   <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># objective function</span>
    <span class="n">m</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">,</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">)</span>
    
    <span class="c1"># constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">])</span>

    <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;cbc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">](),</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]()</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]}</span>
        
    <span class="k">return</span> <span class="n">SCHEDULE</span>

<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 1.0,
 &#39;Makespan&#39;: 12.0,
 &#39;Max Pastdue&#39;: 0,
 &#39;Number Pastdue&#39;: 0,
 &#39;Number on Time&#39;: 7,
 &#39;Sum of Pastdue&#39;: 0}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_33_1.png" src="../../_images/03.02-Machine-Bottleneck_33_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_33_2.png" src="../../_images/03.02-Machine-Bottleneck_33_2.png" />
</div>
</div>
</div>
<div class="section" id="step-3-machine-conflict-constraints">
<h3>Step 3. Machine conflict constraints<a class="headerlink" href="#step-3-machine-conflict-constraints" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>

    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    
    <span class="c1"># index set to simplify notation</span>
    <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">dimen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1"># decision variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">finish</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Boolean</span><span class="p">)</span>
    
    <span class="c1"># additional decision variables for use in the objecive</span>
    <span class="n">m</span><span class="o">.</span><span class="n">makespan</span>   <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># objective function</span>
    <span class="n">m</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">,</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">)</span>
    
    <span class="c1"># constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">])</span>
    
    <span class="n">M</span> <span class="o">=</span> <span class="mf">100.0</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>

    <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;cbc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">](),</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]()</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]}</span>
        
    <span class="k">return</span> <span class="n">SCHEDULE</span>

<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.42857142857142855,
 &#39;Makespan&#39;: 30.0,
 &#39;Max Pastdue&#39;: 15.0,
 &#39;Number Pastdue&#39;: 4,
 &#39;Number on Time&#39;: 3,
 &#39;Sum of Pastdue&#39;: 37.0}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_35_1.png" src="../../_images/03.02-Machine-Bottleneck_35_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_35_2.png" src="../../_images/03.02-Machine-Bottleneck_35_2.png" />
</div>
</div>
</div>
<div class="section" id="step-4-improve-the-objective-function">
<h3>Step 4. Improve the objective function<a class="headerlink" href="#step-4-improve-the-objective-function" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>

    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    
    <span class="c1"># index set to simplify notation</span>
    <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">dimen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1"># decision variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">finish</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Boolean</span><span class="p">)</span>
    
    <span class="c1"># additional decision variables for use in the objecive</span>
    <span class="n">m</span><span class="o">.</span><span class="n">makespan</span>   <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># objective function</span>
    <span class="n">m</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">),</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">)</span>
    
    <span class="c1"># constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">ConstraintList</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    
    <span class="n">M</span> <span class="o">=</span> <span class="mf">100.0</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">:</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">finish</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>

    <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;cbc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">JOBS</span><span class="p">:</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">](),</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]()</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]}</span>
        
    <span class="k">return</span> <span class="n">SCHEDULE</span>

<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.7142857142857143,
 &#39;Makespan&#39;: 30.0,
 &#39;Max Pastdue&#39;: 15.0,
 &#39;Number Pastdue&#39;: 2,
 &#39;Number on Time&#39;: 5,
 &#39;Sum of Pastdue&#39;: 16.0}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_37_1.png" src="../../_images/03.02-Machine-Bottleneck_37_1.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_37_2.png" src="../../_images/03.02-Machine-Bottleneck_37_2.png" />
</div>
</div>
</div>
</div>
<div class="section" id="pyomo-model">
<h2>Pyomo model<a class="headerlink" href="#pyomo-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">):</span>

    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    
    <span class="c1"># index set to simplify notation</span>
    <span class="n">m</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">dimen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1"># upper bounds on how long it would take to process all jobs</span>
    <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">])</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">])</span>

    <span class="c1"># decision variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span>      <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span>    <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">early</span>      <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">))</span>
    
    <span class="c1"># additional decision variables for use in the objecive</span>
    <span class="n">m</span><span class="o">.</span><span class="n">makespan</span>   <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">maxpastdue</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tmax</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">ispastdue</span>  <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="c1"># objective function</span>
    <span class="n">m</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">]),</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">)</span>

    <span class="c1"># constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> 
            <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">early</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c3</span> <span class="o">=</span> <span class="n">Disjunction</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span>
        <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> 
         <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>    
    
    <span class="n">m</span><span class="o">.</span><span class="n">c4</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">maxpastdue</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c5</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c6</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">tmax</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">ispastdue</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    
    <span class="n">TransformationFactory</span><span class="p">(</span><span class="s1">&#39;gdp.chull&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;cbc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
    
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">:</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">](),</span> <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]()</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]}</span>
        
    <span class="k">return</span> <span class="n">SCHEDULE</span>

<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">opt_schedule</span><span class="p">(</span><span class="n">JOBS</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: DEPRECATED: The &#39;gdp.chull&#39; name is deprecated. Please use the more
    apt &#39;gdp.hull&#39; instead.  (deprecated in 5.7) (called from
    /usr/local/lib/python3.6/dist-packages/pyutilib/factory/factory.py:43)
# ==========================================================
# = Solver Results                                         =
# ==========================================================
# ----------------------------------------------------------
#   Problem Information
# ----------------------------------------------------------
Problem: 
- Name: unknown
  Lower bound: 16.0
  Upper bound: 16.0
  Number of objectives: 1
  Number of constraints: 133
  Number of variables: 77
  Number of binary variables: 49
  Number of integer variables: 49
  Number of nonzeros: 7
  Sense: minimize
# ----------------------------------------------------------
#   Solver Information
# ----------------------------------------------------------
Solver: 
- Status: ok
  User time: -1.0
  System time: 0.47
  Wallclock time: 0.47
  Termination condition: optimal
  Termination message: Model was solved to optimality (subject to tolerances), and an optimal solution is available.
  Statistics: 
    Branch and bound: 
      Number of bounded subproblems: 30
      Number of created subproblems: 30
    Black box: 
      Number of iterations: 5588
  Error rc: 0
  Time: 0.493694543838501
# ----------------------------------------------------------
#   Solution Information
# ----------------------------------------------------------
Solution: 
- number of solutions: 0
  number of solutions displayed: 0
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 0.7142857142857143,
 &#39;Makespan&#39;: 30.0,
 &#39;Max Pastdue&#39;: 15.0,
 &#39;Number Pastdue&#39;: 2,
 &#39;Number on Time&#39;: 5,
 &#39;Sum of Pastdue&#39;: 16.0}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_39_2.png" src="../../_images/03.02-Machine-Bottleneck_39_2.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_39_3.png" src="../../_images/03.02-Machine-Bottleneck_39_3.png" />
</div>
</div>
</div>
<div class="section" id="multiple-machines">
<h2>Multiple machines<a class="headerlink" href="#multiple-machines" title="Permalink to this headline">¶</a></h2>
<p>The case of multiple machines requires a modest extension of model described above. Given a set <span class="math notranslate nohighlight">\(M\)</span> of machines, we introduce an additional decision binary variable <span class="math notranslate nohighlight">\(z_{j,m}\)</span> indicating if job <span class="math notranslate nohighlight">\(j\)</span> has been assigned to machine <span class="math notranslate nohighlight">\(m\)</span>. The additional constraints</p>
<p>\begin{align*}
\sum_{m\in M}z_{j,m} &amp; = 1 &amp; \forall j
\end{align*}</p>
<p>require each job to be assigned to exactly one machine for processing.</p>
<p>If both jobs <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(k\)</span> have been assigned to machine <span class="math notranslate nohighlight">\(m\)</span>, then the disjunctive ordering constraints must apply.  This logic is equivalent to the following constraints for <span class="math notranslate nohighlight">\(j &lt; k\)</span>.</p>
<p>\begin{align*}
\text{start}<em>{j}+\text{duration}</em>{j} &amp; \leq \text{start}<em>{k}+My</em>{j,k} + M(1-z_{j,m}) + M(1-z_{k,m})\
\text{start}<em>{k}+\text{duration}</em>{k} &amp; \leq \text{start}<em>{j}+M(1-y</em>{j,k}) + M(1-z_{j,m}) + M(1-z_{k,m}))
\end{align*}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MACHINES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">schedule_machines</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">MACHINES</span><span class="p">):</span>
    
    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    
    <span class="c1"># index set to simplify notation</span>
    <span class="n">m</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">m</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">MACHINES</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">dimen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1"># decision variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span>      <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">makespan</span>   <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span>    <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">early</span>      <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># additional decision variables for use in the objecive</span>
    <span class="n">m</span><span class="o">.</span><span class="n">ispastdue</span>  <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">maxpastdue</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># for binary assignment of jobs to machines</span>
    <span class="n">m</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="c1"># for modeling disjunctive constraints</span>
    <span class="n">m</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>
    <span class="n">BigM</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">])</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">])</span>

    <span class="n">m</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">early</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">),</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> 
            <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">early</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c3</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> 
            <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">mach</span><span class="p">]</span> <span class="k">for</span> <span class="n">mach</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c4</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> 
            <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">BigM</span><span class="o">*</span><span class="n">m</span><span class="o">.</span><span class="n">ispastdue</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c5</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> 
            <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">maxpastdue</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c6</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> 
            <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">d1</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">,</span> <span class="n">rule</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">mach</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">BigM</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">mach</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">mach</span><span class="p">])))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">d2</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">,</span> <span class="n">rule</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">mach</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> 
            <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">BigM</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">mach</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">mach</span><span class="p">])))</span>
    
    <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;cbc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
    
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">:</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">](),</span> 
            <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]()</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">],</span>
            <span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mach</span> <span class="k">for</span> <span class="n">mach</span> <span class="ow">in</span> <span class="n">MACHINES</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">mach</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
        
    <span class="k">return</span> <span class="n">SCHEDULE</span>
        
<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">schedule_machines</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span><span class="n">MACHINES</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># ==========================================================
# = Solver Results                                         =
# ==========================================================
# ----------------------------------------------------------
#   Problem Information
# ----------------------------------------------------------
Problem: 
- Name: unknown
  Lower bound: -15.0
  Upper bound: -15.0
  Number of objectives: 1
  Number of constraints: 98
  Number of variables: 50
  Number of binary variables: 42
  Number of integer variables: 42
  Number of nonzeros: 15
  Sense: minimize
# ----------------------------------------------------------
#   Solver Information
# ----------------------------------------------------------
Solver: 
- Status: ok
  User time: -1.0
  System time: 0.46
  Wallclock time: 0.49
  Termination condition: optimal
  Termination message: Model was solved to optimality (subject to tolerances), and an optimal solution is available.
  Statistics: 
    Branch and bound: 
      Number of bounded subproblems: 46
      Number of created subproblems: 46
    Black box: 
      Number of iterations: 3784
  Error rc: 0
  Time: 0.5037832260131836
# ----------------------------------------------------------
#   Solution Information
# ----------------------------------------------------------
Solution: 
- number of solutions: 0
  number of solutions displayed: 0
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 1.0,
 &#39;Makespan&#39;: 15.0,
 &#39;Max Pastdue&#39;: 0,
 &#39;Number Pastdue&#39;: 0,
 &#39;Number on Time&#39;: 7,
 &#39;Sum of Pastdue&#39;: 0}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_41_2.png" src="../../_images/03.02-Machine-Bottleneck_41_2.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_41_3.png" src="../../_images/03.02-Machine-Bottleneck_41_3.png" />
</div>
</div>
</div>
<div class="section" id="disjunctive-version">
<h2>Disjunctive Version<a class="headerlink" href="#disjunctive-version" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MACHINES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">schedule_machines</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">MACHINES</span><span class="p">):</span>
    
    <span class="c1"># create model</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">ConcreteModel</span><span class="p">()</span>
    
    <span class="c1"># index set to simplify notation</span>
    <span class="n">m</span><span class="o">.</span><span class="n">J</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">JOBS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">m</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span><span class="o">=</span><span class="n">MACHINES</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">dimen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1"># decision variables</span>
    <span class="n">m</span><span class="o">.</span><span class="n">start</span>      <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">makespan</span>   <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span>    <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">early</span>      <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">))</span>
    
    <span class="c1"># additional decision variables for use in the objecive</span>
    <span class="n">m</span><span class="o">.</span><span class="n">ispastdue</span>  <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">maxpastdue</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">NonNegativeReals</span><span class="p">)</span>
    
    <span class="c1"># for binary assignment of jobs to machines</span>
    <span class="n">m</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">Binary</span><span class="p">)</span>

    <span class="c1"># for modeling disjunctive constraints</span>
    <span class="n">BigM</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">])</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">])</span>

    <span class="n">m</span><span class="o">.</span><span class="n">OBJ</span> <span class="o">=</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">early</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">),</span> <span class="n">sense</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">)</span>

    <span class="c1"># job starts after it is released</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;release&#39;</span><span class="p">])</span>

    <span class="c1"># defines early and pastdue</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">early</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;due&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">m</span><span class="o">.</span><span class="n">d1</span> <span class="o">=</span> <span class="n">Disjunction</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">early</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># each job is assigned to one and only one machine</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c3</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">mach</span><span class="p">]</span> <span class="k">for</span> <span class="n">mach</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># defines a binary variable indicating if a job is past due</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c4</span> <span class="o">=</span> <span class="n">Disjunction</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">ispastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># all jobs must be finished before max pastdue</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c5</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">pastdue</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">maxpastdue</span><span class="p">)</span>

    <span class="c1"># defining make span</span>
    <span class="n">m</span><span class="o">.</span><span class="n">c6</span> <span class="o">=</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">makespan</span><span class="p">)</span>
 
    <span class="c1"># disjuctions</span>
    <span class="n">m</span><span class="o">.</span><span class="n">d0</span> <span class="o">=</span> <span class="n">Disjunction</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">M</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">PAIRS</span><span class="p">,</span> <span class="n">rule</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">mach</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> 
                       <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">BigM</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">mach</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">mach</span><span class="p">])),</span>
                        <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">BigM</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">mach</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">mach</span><span class="p">]))])</span>
  
    <span class="n">transform</span> <span class="o">=</span> <span class="n">TransformationFactory</span><span class="p">(</span><span class="s1">&#39;gdp.hull&#39;</span><span class="p">)</span>
    <span class="n">transform</span><span class="o">.</span><span class="n">apply_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="n">SolverFactory</span><span class="p">(</span><span class="s1">&#39;cbc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
    
    <span class="n">SCHEDULE</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">J</span><span class="p">:</span>
        <span class="n">SCHEDULE</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">](),</span> 
            <span class="s1">&#39;finish&#39;</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="n">j</span><span class="p">]()</span> <span class="o">+</span> <span class="n">JOBS</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">],</span>
            <span class="s1">&#39;machine&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mach</span> <span class="k">for</span> <span class="n">mach</span> <span class="ow">in</span> <span class="n">MACHINES</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">mach</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
        
    <span class="k">return</span> <span class="n">SCHEDULE</span>
        
<span class="n">SCHEDULE</span> <span class="o">=</span> <span class="n">schedule_machines</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span><span class="n">MACHINES</span><span class="p">)</span>
<span class="n">gantt</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
<span class="n">kpi</span><span class="p">(</span><span class="n">JOBS</span><span class="p">,</span> <span class="n">SCHEDULE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># ==========================================================
# = Solver Results                                         =
# ==========================================================
# ----------------------------------------------------------
#   Problem Information
# ----------------------------------------------------------
Problem: 
- Name: unknown
  Lower bound: -15.0
  Upper bound: -15.0
  Number of objectives: 1
  Number of constraints: 637
  Number of variables: 435
  Number of binary variables: 133
  Number of integer variables: 133
  Number of nonzeros: 15
  Sense: minimize
# ----------------------------------------------------------
#   Solver Information
# ----------------------------------------------------------
Solver: 
- Status: ok
  User time: -1.0
  System time: 2.07
  Wallclock time: 2.12
  Termination condition: optimal
  Termination message: Model was solved to optimality (subject to tolerances), and an optimal solution is available.
  Statistics: 
    Branch and bound: 
      Number of bounded subproblems: 477
      Number of created subproblems: 477
    Black box: 
      Number of iterations: 7096
  Error rc: 0
  Time: 2.1357791423797607
# ----------------------------------------------------------
#   Solution Information
# ----------------------------------------------------------
Solution: 
- number of solutions: 0
  number of solutions displayed: 0
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Fraction on Time&#39;: 1.0,
 &#39;Makespan&#39;: 15.0,
 &#39;Max Pastdue&#39;: 0,
 &#39;Number Pastdue&#39;: 0,
 &#39;Number on Time&#39;: 7,
 &#39;Sum of Pastdue&#39;: 0}
</pre></div>
</div>
<img alt="../../_images/03.02-Machine-Bottleneck_43_2.png" src="../../_images/03.02-Machine-Bottleneck_43_2.png" />
<img alt="../../_images/03.02-Machine-Bottleneck_43_3.png" src="../../_images/03.02-Machine-Bottleneck_43_3.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Chapter 3</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="03.03-Job-Shop-Scheduling.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Job Shop Scheduling</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The MO Book group<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>